
services:
  frontend:
    restart: on-failure
    build: ./reactapp
    container_name: frontend
    ports:
      - '4001:3000'
    environment:
      - REACT_APP_BACKEND_URL=http://host.docker.internal:4000/tasks
    networks:
      - proxy-frontend

  backend:
    restart: on-failure
    build: ./webapi
    container_name: backend
    ports:
      - '4000:80'
    environment:
      - Cors:AllowedOrigins=http://localhost:4002
    networks:
      - proxy-backend

  proxy:
    restart: on-failure
    build: ./nginx
    container_name: proxy
    ports:
      - '4002:8080'
    networks:
      - proxy-frontend
      - proxy-backend
    depends_on:
      - frontend
      - backend

networks:
  proxy-frontend:
    name: proxy-frontend
  proxy-backend:
    name: proxy-backend